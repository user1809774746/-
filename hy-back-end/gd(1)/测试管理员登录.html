<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯•ç®¡ç†å‘˜ç™»å½•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            color: #333;
            text-align: center;
        }
        
        button {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            font-size: 16px;
            font-weight: bold;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            color: white;
        }
        
        .btn-admin {
            background: #007bff;
        }
        
        .btn-user {
            background: #28a745;
        }
        
        .result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
            white-space: pre-wrap;
            font-family: monospace;
            font-size: 14px;
        }
        
        .success {
            background: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
        }
        
        .error {
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            color: #721c24;
        }
        
        .info {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            color: #0c5460;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§ª ç®¡ç†å‘˜ç™»å½•æµ‹è¯•</h1>
        
        <button class="btn-admin" onclick="testAdminLogin()">
            æµ‹è¯•ç®¡ç†å‘˜ç™»å½•ï¼ˆuserType: "admin"ï¼‰
        </button>
        
        <button class="btn-user" onclick="testUserLogin()">
            æµ‹è¯•æ™®é€šç”¨æˆ·ç™»å½•ï¼ˆuserType: "user"ï¼‰
        </button>
        
        <button class="btn-admin" onclick="testAdminWithWrongType()">
            æµ‹è¯•é”™è¯¯ç±»å‹ï¼ˆç®¡ç†å‘˜è´¦å· + userType: "user"ï¼‰
        </button>
        
        <div id="results"></div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8081';
        
        function addResult(message, type = 'info') {
            const results = document.getElementById('results');
            const div = document.createElement('div');
            div.className = `result ${type}`;
            div.textContent = message;
            results.appendChild(div);
            div.scrollIntoView({ behavior: 'smooth' });
        }
        
        function clearResults() {
            document.getElementById('results').innerHTML = '';
        }
        
        async function testAdminLogin() {
            clearResults();
            addResult('=== æµ‹è¯•ç®¡ç†å‘˜ç™»å½• ===\n', 'info');
            addResult('å‘é€è¯·æ±‚...\nPOST /api/auth/login\n{\n  phone: "18888888888",\n  password: "123123",\n  userType: "admin"\n}', 'info');
            
            try {
                const response = await fetch(`${API_BASE}/api/auth/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        phone: "18888888888",
                        password: "123123",
                        userType: "admin"
                    })
                });
                
                const data = await response.json();
                
                addResult(`\nHTTPçŠ¶æ€ç : ${response.status}`, 'info');
                addResult(`\nå“åº”æ•°æ®:\n${JSON.stringify(data, null, 2)}`, data.code === 200 ? 'success' : 'error');
                
                if (data.code === 200) {
                    addResult('\nâœ… ç®¡ç†å‘˜ç™»å½•æˆåŠŸï¼', 'success');
                    addResult(`Token: ${data.data.token.substring(0, 50)}...`, 'success');
                    addResult(`UserType: ${data.data.userType}`, 'success');
                } else {
                    addResult(`\nâŒ ç™»å½•å¤±è´¥: ${data.message}`, 'error');
                }
                
            } catch (error) {
                addResult(`\nâŒ è¯·æ±‚å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        async function testUserLogin() {
            clearResults();
            addResult('=== æµ‹è¯•æ™®é€šç”¨æˆ·ç™»å½• ===\n', 'info');
            addResult('å‘é€è¯·æ±‚...\nPOST /api/auth/login\n{\n  phone: "13800138000",\n  password: "123456",\n  userType: "user"\n}', 'info');
            
            try {
                const response = await fetch(`${API_BASE}/api/auth/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        phone: "13800138000",
                        password: "123456",
                        userType: "user"
                    })
                });
                
                const data = await response.json();
                
                addResult(`\nHTTPçŠ¶æ€ç : ${response.status}`, 'info');
                addResult(`\nå“åº”æ•°æ®:\n${JSON.stringify(data, null, 2)}`, data.code === 200 ? 'success' : 'error');
                
                if (data.code === 200) {
                    addResult('\nâœ… æ™®é€šç”¨æˆ·ç™»å½•æˆåŠŸï¼', 'success');
                } else {
                    addResult(`\nâŒ ç™»å½•å¤±è´¥: ${data.message}`, 'error');
                }
                
            } catch (error) {
                addResult(`\nâŒ è¯·æ±‚å¤±è´¥: ${error.message}`, 'error');
            }
        }
        
        async function testAdminWithWrongType() {
            clearResults();
            addResult('=== æµ‹è¯•é”™è¯¯ç±»å‹ï¼ˆç®¡ç†å‘˜è´¦å· + userç±»å‹ï¼‰===\n', 'info');
            addResult('å‘é€è¯·æ±‚...\nPOST /api/auth/login\n{\n  phone: "18888888888",\n  password: "123123",\n  userType: "user"  â† é”™è¯¯ï¼\n}', 'info');
            
            try {
                const response = await fetch(`${API_BASE}/api/auth/login`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        phone: "18888888888",
                        password: "123123",
                        userType: "user"  // é”™è¯¯ï¼šåº”è¯¥æ˜¯ admin
                    })
                });
                
                const data = await response.json();
                
                addResult(`\nHTTPçŠ¶æ€ç : ${response.status}`, 'info');
                addResult(`\nå“åº”æ•°æ®:\n${JSON.stringify(data, null, 2)}`, 'error');
                addResult('\nâŒ é¢„æœŸç»“æœï¼šç™»å½•å¤±è´¥ï¼ˆå› ä¸ºåœ¨user_infoè¡¨ä¸­æ‰¾ä¸åˆ°è¿™ä¸ªæ‰‹æœºå·ï¼‰', 'error');
                
            } catch (error) {
                addResult(`\nâŒ è¯·æ±‚å¤±è´¥: ${error.message}`, 'error');
            }
        }
    </script>
</body>
</html>
