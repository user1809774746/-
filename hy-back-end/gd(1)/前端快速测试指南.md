# 前端快速测试指南 - 管理员注册登录

> **快速版**：只需5分钟，3个步骤解决问题  
> **适用场景**：解决管理员登录密码验证失败问题

---

## 🚀 执行步骤

### 第1步：重建数据库表（MySQL客户端）

```sql
-- 复制整段SQL执行
DROP TABLE IF EXISTS `administrator_info`;

CREATE TABLE `administrator_info`  (
  `adminid` bigint NOT NULL AUTO_INCREMENT,
  `admin_name` varchar(255) NOT NULL,
  `phone` varchar(20) NOT NULL,
  `password` varchar(255) NOT NULL,
  `creation_date` datetime NULL DEFAULT CURRENT_TIMESTAMP,
  `last_login_date` datetime NULL DEFAULT NULL,
  `active_token` varchar(500) NULL DEFAULT NULL,
  `token_created_at` datetime NULL DEFAULT NULL,
  `token_expires_at` datetime NULL DEFAULT NULL,
  PRIMARY KEY (`adminid`),
  UNIQUE INDEX `UK_admin_name`(`admin_name`),
  UNIQUE INDEX `UK_phone`(`phone`),
  INDEX `idx_active_token`(`active_token`(255))
) ENGINE = InnoDB CHARACTER SET = utf8mb4 COLLATE = utf8mb4_general_ci;
```

✅ **执行成功标志**：显示 "Query OK"

---

### 第2步：注册管理员（浏览器控制台）

打开浏览器控制台（按 F12），复制粘贴执行：

```javascript
fetch('http://localhost:8081/api/auth/admin/quick-register', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    phone: "18888888888",
    password: "123123"
  })
})
.then(res => res.json())
.then(data => {
  console.log(data);
  if (data.code === 200) {
    alert('✅ 管理员注册成功！\n手机号: 18888888888\n密码: 123123');
  } else {
    alert('❌ 失败: ' + data.message);
  }
});
```

✅ **成功标志**：弹窗显示"管理员注册成功"

---

### 第3步：测试登录（浏览器控制台）

```javascript
fetch('http://localhost:8081/api/auth/login', {
  method: 'POST',
  headers: { 'Content-Type': 'application/json' },
  body: JSON.stringify({
    phone: "18888888888",
    password: "123123",
    userType: "admin"
  })
})
.then(res => res.json())
.then(data => {
  console.log(data);
  if (data.code === 200) {
    alert('✅ 登录成功！\nToken: ' + data.data.token);
  } else {
    alert('❌ 失败: ' + data.message);
  }
});
```

✅ **成功标志**：弹窗显示"登录成功"并返回Token

---

## 🎯 前端登录页面测试

控制台测试成功后，使用前端页面测试：

1. 打开登录页面
2. 用户类型：选择 **管理员**
3. 手机号：`18888888888`
4. 密码：`123123`
5. 点击登录

✅ **成功标志**：自动跳转到管理员后台

---

## 📡 新增接口说明

### 管理员快速注册接口

**接口地址**：`POST /api/auth/admin/quick-register`

**请求示例**：
```json
{
  "phone": "18888888888",
  "password": "123123"
}
```

**成功响应**：
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "phone": "18888888888",
    "message": "管理员注册成功"
  }
}
```

**错误响应**：
```json
{
  "code": 400,
  "message": "该手机号已注册为管理员",
  "data": null
}
```

---

## ❓ 常见问题

### Q1：注册时提示"该手机号已注册"

**解决**：在MySQL中删除该管理员

```sql
DELETE FROM administrator_info WHERE phone = '18888888888';
```

然后重新注册。

---

### Q2：登录时仍然提示"密码错误"

**检查步骤**：

1. 确认注册成功（查询数据库）
```sql
SELECT phone, LEFT(password, 20) as pwd FROM administrator_info;
```

2. 密码应该是 `$2a$10$...` 开头（BCrypt格式）

3. 如果不是，重新执行步骤2注册

---

### Q3：前端无法访问后端接口

**检查**：
- 后端是否启动？
- 端口是否为 8081？
- CORS是否配置？

---

## 📝 测试账号

注册成功后的测试账号：

```
手机号：18888888888
密码：123123
类型：管理员
```

---

## 🎉 成功后可以做什么？

1. ✅ 管理员登录
2. ✅ 访问帖子审核页面
3. ✅ 审核用户发布的帖子
4. ✅ 设置精选、置顶帖子
5. ✅ 删除违规帖子

---

**就这么简单！3个步骤，5分钟解决！** 🚀

