# è·¯çº¿æ”¶è—åŠŸèƒ½ - å¿«é€Ÿå¼€å§‹ ğŸš€

## âœ… å·²å®ŒæˆåŠŸèƒ½

è·¯çº¿æ”¶è—åŠŸèƒ½å·²å…¨éƒ¨å®ç°å¹¶å¯ä»¥ä½¿ç”¨ï¼æ”¯æŒä¸¤ç§æ”¶è—æ¨¡å¼ï¼š

### ğŸ“Œ æ¨¡å¼ä¸€ï¼šæ”¶è—å·²æœ‰æ–¹æ¡ˆ
é€‚ç”¨äºï¼šæ”¶è—æ•°æ®åº“ä¸­é¢„è®¾çš„æ—…æ¸¸æ–¹æ¡ˆï¼ˆå¦‚å¤©æ´¥3æ—¥æ¸¸ã€å‘¼ä¼¦è´å°”3æ—¥æ¸¸ç­‰ï¼‰

```bash
# æ”¶è—æ–¹æ¡ˆIDä¸º1çš„è·¯çº¿
POST /api/favorites/route/1
Authorization: Bearer <token>
```

### ğŸ“Œ æ¨¡å¼äºŒï¼šæ”¶è—è‡ªå®šä¹‰è·¯çº¿
é€‚ç”¨äºï¼šæ”¶è—ç”¨æˆ·è‡ªå·±è§„åˆ’çš„è·¯çº¿

```bash
# æ”¶è—ç”¨æˆ·è§„åˆ’çš„è·¯çº¿
POST /api/favorites/route/custom
Content-Type: application/json
Authorization: Bearer <token>

{
  "trip_title": "æˆ‘çš„å¹¿å·3æ—¥æ¸¸",
  "total_days": 3,
  "summary": "è‡ªå®šä¹‰è·¯çº¿",
  "days": [...]
}
```

---

## ğŸ¯ æ ¸å¿ƒæ¥å£ï¼ˆ5ä¸ªï¼‰

| åŠŸèƒ½ | æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|------|
| **æ”¶è—å·²æœ‰æ–¹æ¡ˆ** | POST | /api/favorites/route/{routeId} | é€šè¿‡IDæ”¶è—é¢„è®¾æ–¹æ¡ˆ |
| **æ”¶è—è‡ªå®šä¹‰è·¯çº¿** | POST | /api/favorites/route/custom | æ”¶è—ç”¨æˆ·è§„åˆ’è·¯çº¿ |
| **å–æ¶ˆæ”¶è—** | DELETE | /api/favorites/route/{routeId} | è½¯åˆ é™¤ï¼Œå¯æ¢å¤ |
| **æ£€æŸ¥æ”¶è—çŠ¶æ€** | GET | /api/favorites/route/{routeId}/status | è¿”å› isFavorited |
| **è·å–æ”¶è—åˆ—è¡¨** | GET | /api/favorites/route/list | è¿”å›æ‰€æœ‰æœ‰æ•ˆæ”¶è— |

---

## ğŸ§ª å¿«é€Ÿæµ‹è¯•ï¼ˆ3åˆ†é’Ÿï¼‰

### Step 1: å‡†å¤‡ Token
```bash
# å…ˆç™»å½•è·å– token
POST /api/auth/login
{
  "phone": "ä½ çš„æ‰‹æœºå·",
  "password": "ä½ çš„å¯†ç "
}

# å°†è¿”å›çš„ token ä¿å­˜
TOKEN="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
```

### Step 2: æ”¶è—å·²æœ‰æ–¹æ¡ˆ
```bash
curl -X POST "http://localhost:8081/api/favorites/route/1" \
  -H "Authorization: Bearer $TOKEN"

# é¢„æœŸå“åº”ï¼š
# {
#   "code": 200,
#   "data": {
#     "trip_title": "å¤©æ´¥3æ—¥ç»å…¸æ–‡åŒ–æ¸¸",
#     "total_days": 3,
#     ...
#   }
# }
```

### Step 3: æ£€æŸ¥æ”¶è—çŠ¶æ€
```bash
curl -X GET "http://localhost:8081/api/favorites/route/1/status" \
  -H "Authorization: Bearer $TOKEN"

# é¢„æœŸå“åº”ï¼š
# {
#   "code": 200,
#   "data": {
#     "routeId": 1,
#     "isFavorited": true
#   }
# }
```

### Step 4: æŸ¥çœ‹æ”¶è—åˆ—è¡¨
```bash
curl -X GET "http://localhost:8081/api/favorites/route/list" \
  -H "Authorization: Bearer $TOKEN"

# é¢„æœŸå“åº”ï¼š
# {
#   "code": 200,
#   "data": {
#     "total": 1,
#     "list": [...]
#   }
# }
```

### Step 5: å–æ¶ˆæ”¶è—
```bash
curl -X DELETE "http://localhost:8081/api/favorites/route/1" \
  -H "Authorization: Bearer $TOKEN"

# é¢„æœŸå“åº”ï¼š
# {
#   "code": 200,
#   "data": {
#     "message": "å–æ¶ˆè·¯çº¿æ”¶è—æˆåŠŸ"
#   }
# }
```

---

## ğŸ“Š æ•°æ®åº“ä¸­çš„é¢„è®¾æ–¹æ¡ˆ

å½“å‰æ•°æ®åº“ä¸­æœ‰ä»¥ä¸‹é¢„è®¾æ–¹æ¡ˆå¯ä¾›æ”¶è—ï¼š

| ID | æ ‡é¢˜ | å¤©æ•° | åŸå¸‚ |
|----|------|------|------|
| 1 | å¤©æ´¥3æ—¥ç»å…¸æ–‡åŒ–æ¸¸ | 3 | å¤©æ´¥ |
| 2 | å‘¼ä¼¦è´å°”æµ·æ‹‰å°”3æ—¥æ–‡åŒ–è‡ªç„¶ä¹‹æ—… | 3 | å‘¼ä¼¦è´å°” |
| 3 | æ²ˆé˜³3æ—¥å†å²æ–‡åŒ–ä¸ä¼‘é—²ä¹‹æ—… | 3 | æ²ˆé˜³ |
| 4 | æ²ˆé˜³3æ—¥å†å²æ–‡åŒ–ä¸ä¼‘é—²ä¹‹æ—… | 3 | æ²ˆé˜³ |

---

## ğŸ’» å‰ç«¯ä½¿ç”¨ç¤ºä¾‹

### Vue 3 ç®€å•ç¤ºä¾‹

```vue
<script setup>
import { ref } from 'vue';
import axios from 'axios';

const isFavorited = ref(false);

// æ”¶è—å·²æœ‰æ–¹æ¡ˆ
async function favoriteRoute(routeId) {
  const res = await axios.post(`/api/favorites/route/${routeId}`);
  if (res.data.code === 200) {
    isFavorited.value = true;
    alert('æ”¶è—æˆåŠŸï¼');
  }
}

// å–æ¶ˆæ”¶è—
async function unfavoriteRoute(routeId) {
  const res = await axios.delete(`/api/favorites/route/${routeId}`);
  if (res.data.code === 200) {
    isFavorited.value = false;
    alert('å–æ¶ˆæ”¶è—æˆåŠŸï¼');
  }
}
</script>

<template>
  <button @click="favoriteRoute(1)">
    {{ isFavorited ? 'â¤ï¸ å·²æ”¶è—' : 'ğŸ¤ æ”¶è—' }}
  </button>
</template>
```

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### 1ï¸âƒ£ å¹‚ç­‰æ€§
- é‡å¤æ”¶è—åŒä¸€è·¯çº¿ä¸ä¼šæŠ¥é”™
- è‡ªåŠ¨è¯†åˆ«å¹¶è¿”å›æˆåŠŸ

### 2ï¸âƒ£ è½¯åˆ é™¤
- å–æ¶ˆæ”¶è—ä¸ä¼šæ°¸ä¹…åˆ é™¤
- é‡æ–°æ”¶è—å¯æ¢å¤ä¹‹å‰çš„è®°å½•

### 3ï¸âƒ£ åŒæ¨¡å¼
- **æ¨¡å¼ä¸€**ï¼šæ”¶è—é¢„è®¾æ–¹æ¡ˆï¼ˆåªéœ€ routeIdï¼‰
- **æ¨¡å¼äºŒ**ï¼šæ”¶è—è‡ªå®šä¹‰è·¯çº¿ï¼ˆæä¾›å®Œæ•´æ•°æ®ï¼‰

### 4ï¸âƒ£ å®Œæ•´åŠŸèƒ½
- âœ… æ·»åŠ æ”¶è—
- âœ… å–æ¶ˆæ”¶è—
- âœ… æ£€æŸ¥çŠ¶æ€
- âœ… è·å–åˆ—è¡¨

---

## ğŸ”§ ç›¸å…³æ–‡ä»¶

| æ–‡ä»¶ç±»å‹ | è·¯å¾„ |
|---------|------|
| **Controller** | `src/main/java/com/example/auth/controller/RouteFavoriteController.java` |
| **Service** | `src/main/java/com/example/auth/service/TripSchemeService.java` |
| **Entity** | `src/main/java/com/example/auth/entity/RouteFavorite.java` |
| **Entity** | `src/main/java/com/example/auth/entity/TripScheme.java` |
| **Repository** | `src/main/java/com/example/auth/repository/RouteFavoriteRepository.java` |
| **DTO** | `src/main/java/com/example/auth/dto/RouteFavoriteResponseDTO.java` |

---

## ğŸ“– è¯¦ç»†æ–‡æ¡£

æ›´å¤šä¿¡æ¯è¯·æŸ¥çœ‹ï¼š
- **å®Œæ•´APIæ–‡æ¡£**ï¼š`æ—…æ¸¸æ–¹æ¡ˆè·¯çº¿æ”¶è—åŠŸèƒ½APIæ–‡æ¡£.md`
- **æ•°æ®åº“è¡¨**ï¼š`trip_schemes.sql` å’Œ `route_favorite.sql`

---

## ğŸ‰ æ€»ç»“

è·¯çº¿æ”¶è—åŠŸèƒ½å·²å…¨éƒ¨å®Œæˆï¼ä½ å¯ä»¥ï¼š
1. âœ… æ”¶è—æ•°æ®åº“ä¸­çš„é¢„è®¾æ–¹æ¡ˆ
2. âœ… æ”¶è—ç”¨æˆ·è‡ªå·±è§„åˆ’çš„è·¯çº¿
3. âœ… å–æ¶ˆæ”¶è—ï¼ˆè½¯åˆ é™¤ï¼‰
4. âœ… æ£€æŸ¥æ”¶è—çŠ¶æ€
5. âœ… è·å–æ”¶è—åˆ—è¡¨

æ‰€æœ‰æ¥å£éƒ½æ”¯æŒå¹‚ç­‰æ€§å’Œé”™è¯¯å¤„ç†ï¼Œå¯ä»¥ç›´æ¥æŠ•å…¥ä½¿ç”¨ï¼ğŸš€

---

**åˆ›å»ºæ—¶é—´**: 2025-11-05  
**åŠŸèƒ½çŠ¶æ€**: âœ… å·²å®Œæˆ  
**ç‰ˆæœ¬**: v1.0

