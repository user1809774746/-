# 用户背景图片接口文档

## 1. 上传背景图片接口

**接口地址**
```
POST /api/user/background-image
```

**请求头**
```
Authorization: Bearer {token}
Content-Type: application/json
```

**请求参数**
```json
{
  "imageBase64": "data:image/jpeg;base64,/9j/4AAQSkZJRg...",
  "imageFormat": "jpeg"
}
```

| 参数 | 类型 | 必填 | 说明 |
|------|------|------|------|
| imageBase64 | String | 是 | Base64编码的图片数据 |
| imageFormat | String | 是 | 图片格式：jpg/jpeg/png/gif |

**成功响应**
```json
{
  "code": 200,
  "message": "背景图片上传成功",
  "data": null
}
```

**错误响应**
```json
{
  "code": 400,
  "message": "图片大小不能超过10MB",
  "data": null
}
```

**注意事项**
- 图片大小限制：10MB
- 支持的格式：jpg、jpeg、png、gif
- 如果已有背景图片，将自动更新为新图片

---

## 2. 获取背景图片接口

### 2.1 获取当前用户背景图片（Base64格式）

**接口地址**
```
GET /api/user/background-image-base64
```

**请求头**
```
Authorization: Bearer {token}
```

**成功响应**
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "backgroundImage": "data:image/jpeg;base64,/9j/4AAQSkZJRg...",
    "phone": "13800138000"
  }
}
```

**使用示例**
```html
<div :style="{ backgroundImage: `url(${response.data.backgroundImage})` }"></div>
```

### 2.2 获取当前用户背景图片（二进制格式）

**接口地址**
```
GET /api/user/background-image
```

**请求头**
```
Authorization: Bearer {token}
```

**成功响应**
- Content-Type: image/jpeg
- Body: 图片二进制数据

**使用示例**
```html
<img src="http://localhost:8080/api/user/background-image" />
```

---

## 前端集成示例

### 上传背景图片
```javascript
async function uploadBackgroundImage(file) {
  const reader = new FileReader();
  reader.readAsDataURL(file);
  
  reader.onload = async () => {
    const response = await fetch('http://localhost:8080/api/user/background-image', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${localStorage.getItem('token')}`
      },
      body: JSON.stringify({
        imageBase64: reader.result,
        imageFormat: file.type.split('/')[1]
      })
    });
    
    const result = await response.json();
    console.log(result);
  };
}
```

### 获取背景图片
```javascript
async function getBackgroundImage() {
  const response = await fetch('http://localhost:8080/api/user/background-image-base64', {
    headers: {
      'Authorization': `Bearer ${localStorage.getItem('token')}`
    }
  });
  
  const result = await response.json();
  if (result.code === 200) {
    document.getElementById('bg').style.backgroundImage = 
      `url(${result.data.backgroundImage})`;
  }
}
```

---

## 错误码说明

| 错误码 | 说明 |
|--------|------|
| 200 | 成功 |
| 400 | 请求参数错误（图片格式不正确、大小超限等） |
| 401 | 未登录或token无效 |
| 404 | 用户未设置背景图片 |
| 500 | 服务器内部错误 |
