# 如何配置AI功能

## 📌 当前状态

✅ **AI功能已关闭** - 应用使用默认路线数据

您看到的404错误是因为工作流ID不存在。不过不用担心，应用会自动使用默认数据，功能完全正常。

---

## 🚀 启用AI功能（可选）

如果您想使用Dify AI生成真实的路线规划，请按以下步骤操作：

### 步骤1：在Dify创建工作流

1. **登录Dify平台**: https://dify.ai/
2. **创建新工作流**
3. **配置输入变量**（3个）：

| 变量名 | 类型 | 说明 | 示例 |
|--------|------|------|------|
| 出发地 | String | 出发地点 | 北京 |
| 目的地 | String | 目的地点 | 上海 |
| 出行方式 | String | 交通方式 | 自驾 |

4. **添加AI节点** - 配置提示词，例如：
```
根据以下信息生成路线规划：
- 出发地：{{出发地}}
- 目的地：{{目的地}}
- 出行方式：{{出行方式}}

请返回JSON格式，包含最快路线和最省钱路线：
{
  "fastest": {
    "time": "时间：XX分钟",
    "description": "路径：详细描述",
    "cost": "费用：￥XX.XX"
  },
  "cheapest": {
    "time": "时间：XX分钟",
    "description": "路径：详细描述",
    "cost": "费用：￥XX.XX"
  }
}
```

5. **启用API访问**
6. **复制工作流ID和API密钥**

---

### 步骤2：更新配置文件

打开文件：`src/config/aiConfig.js`

```javascript
const aiConfig = {
  // 1️⃣ 启用AI功能
  enabled: true,  // ⚠️ 改为 true
  
  // 2️⃣ 替换为您的工作流ID
  workflowId: '您的工作流ID',
  
  // 3️⃣ 替换为您的API密钥
  apiKey: 'app-您的API密钥',
  
  // ... 其他配置保持不变
};
```

**示例**：
```javascript
const aiConfig = {
  enabled: true,
  workflowId: 'abc123-def456-ghi789',
  apiKey: 'app-abcdefghijklmnopqrstuvwxyz',
  // ...
};
```

---

### 步骤3：调整变量名（如果需要）

如果您在Dify中使用**英文变量名**，需要修改：

```javascript
inputFields: {
  startLocation: 'start_location',  // 改为您在Dify中的变量名
  endLocation: 'end_location',
  travelMode: 'travel_mode'
}
```

---

### 步骤4：测试

1. **刷新浏览器** 或 **重启开发服务器**
2. **打开控制台**（F12）
3. **测试路线规划**
4. **查看日志**：
   - ✅ 成功：`"AI返回数据:"`
   - ❌ 失败：`"AI接口错误响应:"`

---

## 🎯 不启用AI也可以正常使用

如果您：
- 暂时不需要AI功能
- 还没有Dify账号
- 想先测试其他功能

**不用担心**！保持配置文件中 `enabled: false`，应用会使用预设的路线数据，所有功能都能正常工作：

✅ 输入出发地和目的地  
✅ 选择出行方式  
✅ 显示路线方案（预设数据）  
✅ 选择最快/最省钱路线  
✅ 跳转地图页面  

---

## 📝 配置文件位置

```
D:\GDMCP\src\config\aiConfig.js
```

用任何文本编辑器打开即可修改。

---

## ❓ 常见问题

### Q1: 修改配置后没有生效？
**A**: 刷新浏览器或重启开发服务器：
```bash
# Ctrl+C 停止服务器
# 然后重新运行
npm run dev
```

### Q2: 仍然出现404错误？
**A**: 检查：
- ✅ 工作流ID是否正确
- ✅ 工作流是否启用了API访问
- ✅ `enabled` 是否设置为 `true`

### Q3: 出现401错误？
**A**: API密钥错误，检查：
- ✅ 密钥是否完整（包括`app-`前缀）
- ✅ 密钥是否有空格或换行
- ✅ 是否复制了正确的密钥

### Q4: AI返回的数据格式不对？
**A**: 在控制台查看 `"AI原始响应:"`，然后根据实际格式调整解析逻辑。

---

## 🎉 总结

- **当前**：AI功能关闭，使用默认数据 ✅
- **可选**：配置Dify后启用AI功能
- **无需**：必须配置AI才能使用应用

随时可以在 `src/config/aiConfig.js` 中切换 `enabled` 来开启/关闭AI功能！

