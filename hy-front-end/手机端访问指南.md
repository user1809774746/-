# 📱 手机端访问指南

## 方法一：局域网访问（推荐）

### 步骤 1：启动开发服务器
在电脑上运行：
```bash
npm run dev
```

### 步骤 2：获取电脑IP地址

**Windows 系统：**
```bash
ipconfig
```
找到 `IPv4 地址`，例如：`192.168.1.100`

**Mac/Linux 系统：**
```bash
ifconfig
```
找到 `inet` 地址，例如：`192.168.1.100`

### 步骤 3：配置 Vite 允许外部访问

修改 `vite.config.js` 文件，添加 `host` 配置：

```javascript
import { defineConfig } from 'vite'
import react from '@vitejs/plugin-react'

export default defineConfig({
  plugins: [react()],
  server: {
    host: '0.0.0.0',  // 允许外部访问
    port: 5173,        // 端口号
  }
})
```

### 步骤 4：在手机端访问

**确保手机和电脑在同一个WiFi网络下**

在手机浏览器中输入：
```
http://你的电脑IP:5173
```

例如：
```
http://192.168.1.100:5173
```

## 方法二：使用 Vite Preview（生产环境）

### 步骤 1：构建生产版本
```bash
npm run build
```

### 步骤 2：预览生产版本
```bash
npm run preview -- --host
```

### 步骤 3：手机访问
```
http://你的电脑IP:4173
```

## 方法三：使用内网穿透（外网访问）

如果你想从外网访问，可以使用以下工具：

### 选项 1：使用 ngrok

1. **安装 ngrok**
   访问 [ngrok.com](https://ngrok.com/) 下载并安装

2. **启动服务**
   ```bash
   # 先启动开发服务器
   npm run dev
   
   # 在另一个终端运行
   ngrok http 5173
   ```

3. **获取链接**
   ngrok会生成一个公网链接，例如：
   ```
   https://xxxx-xx-xx-xx-xx.ngrok.io
   ```
   这个链接可以在任何地方访问！

### 选项 2：使用花生壳（国内）

1. 访问 [花生壳官网](https://hsk.oray.com/)
2. 注册并下载客户端
3. 配置内网穿透
4. 获取域名访问

## 方法四：部署到云服务器

### Vercel 部署（免费，推荐）

1. **安装 Vercel CLI**
   ```bash
   npm install -g vercel
   ```

2. **部署**
   ```bash
   vercel
   ```

3. **获取链接**
   Vercel会自动分配一个域名，例如：
   ```
   https://your-project.vercel.app
   ```

### Netlify 部署（免费）

1. **构建项目**
   ```bash
   npm run build
   ```

2. **访问** [Netlify](https://www.netlify.com/)

3. **拖拽 `dist` 文件夹** 到 Netlify 网站

4. **获取链接**
   ```
   https://your-project.netlify.app
   ```

## 快速开始脚本

我为你准备了一个快速启动脚本，将以下内容保存为 `start-mobile.bat`（Windows）：

```batch
@echo off
echo ========================================
echo 正在启动移动端开发服务器...
echo ========================================

:: 启动开发服务器
npm run dev -- --host

echo.
echo ========================================
echo 服务器已启动！
echo ========================================
echo.
echo 请在手机浏览器中访问以下地址：
echo.
for /f "tokens=2 delims=:" %%a in ('ipconfig ^| findstr /C:"IPv4"') do (
    set IP=%%a
    echo http://!IP:~1!:5173
)
echo.
echo 提示：请确保手机和电脑连接同一个WiFi
echo ========================================

pause
```

**Mac/Linux 用户**，保存为 `start-mobile.sh`：

```bash
#!/bin/bash
echo "========================================"
echo "正在启动移动端开发服务器..."
echo "========================================"

# 启动开发服务器
npm run dev -- --host &

sleep 2

echo ""
echo "========================================"
echo "服务器已启动！"
echo "========================================"
echo ""
echo "请在手机浏览器中访问以下地址："
echo ""

# 获取IP地址
IP=$(ifconfig | grep "inet " | grep -v 127.0.0.1 | awk '{print $2}' | head -n 1)
echo "http://$IP:5173"

echo ""
echo "提示：请确保手机和电脑连接同一个WiFi"
echo "========================================"
```

## 登录时效说明

✅ **已实现登录过期检查**

- 登录有效期：**7天（一周）**
- 超过7天未访问，系统会自动退出登录
- 再次打开时会显示登录页面
- 会提示"登录已过期，请重新登录"

### 登录时效逻辑

```javascript
登录时 → 记录当前时间戳
    ↓
每次打开应用 → 检查时间差
    ↓
时间差 > 7天？
    ├─ 是 → 清除登录信息，显示登录页
    └─ 否 → 保持登录，显示首页
```

## 常见问题

### Q1: 手机无法访问电脑上的服务？
**解决方案：**
1. 确认手机和电脑在同一WiFi
2. 检查电脑防火墙是否允许5173端口
3. 尝试关闭电脑防火墙测试

**Windows 防火墙设置：**
```
控制面板 → Windows Defender 防火墙 
→ 高级设置 → 入站规则 → 新建规则 
→ 端口 → TCP → 特定本地端口：5173
```

### Q2: 如何查看完整的访问地址？
启动服务器后，终端会显示：
```
  ➜  Local:   http://localhost:5173/
  ➜  Network: http://192.168.1.100:5173/
```
使用 `Network` 后面的地址！

### Q3: 登录过期时间可以修改吗？
可以！在 `src/App.jsx` 中修改：

```javascript
// 当前是一周（7天）
const oneWeekInMs = 7 * 24 * 60 * 60 * 1000

// 改为3天
const threeDaysInMs = 3 * 24 * 60 * 60 * 1000

// 改为1天
const oneDayInMs = 1 * 24 * 60 * 60 * 1000

// 改为12小时
const twelveHoursInMs = 12 * 60 * 60 * 1000
```

### Q4: 手机浏览器推荐？
- ✅ Chrome (推荐)
- ✅ Safari (iOS)
- ✅ Edge
- ✅ Firefox

### Q5: 地图在手机上显示异常？
1. 确保高德地图API Key已配置
2. 检查网络连接
3. 尝试刷新页面

## 测试检查清单

在部署前，请在手机上测试以下功能：

- [ ] 登录页面正常显示
- [ ] 注册页面正常显示
- [ ] 验证码倒计时工作正常
- [ ] 首页路线规划功能正常
- [ ] Leaflet地图正常加载
- [ ] 高德地图正常加载
- [ ] 搜索功能正常
- [ ] 定位功能正常
- [ ] 退出登录功能正常
- [ ] 7天后自动退出登录

## 生产环境部署建议

如果要正式上线，建议：

1. **申请域名** - 例如 `travel.yourdomain.com`
2. **配置HTTPS** - 使用 Let's Encrypt 免费SSL证书
3. **使用CDN** - 加速静态资源加载
4. **移动端优化** - 检查响应式布局
5. **PWA支持** - 添加离线支持

## 性能优化建议

对于手机端访问，建议启用以下优化：

1. **图片压缩** - 使用 WebP 格式
2. **代码分割** - 使用 React.lazy
3. **缓存策略** - 配置 Service Worker
4. **压缩资源** - 启用 Gzip/Brotli

---

**提示**: 开发环境下访问速度可能较慢，生产环境构建后会快很多！

需要帮助？请查看 `使用说明.md` 或联系开发团队。


