# æµå¼ä¼ è¾“æ•°æ®è§£æé—®é¢˜ - è°ƒè¯•æŒ‡å—

## ğŸ› é—®é¢˜æè¿°

- **ç°è±¡**ï¼šæ”¶åˆ°1000+æ¡æ¶ˆæ¯ï¼ŒAIè¿”å›äº†æ•°æ®ï¼Œä½†å‰ç«¯æ˜¾ç¤º"æœªæ‰¾åˆ°æœç´¢ç»“æœ"
- **åŸå› **ï¼šæ•°æ®åœ¨ `workflow_finished` äº‹ä»¶ä¸­è¿”å›ï¼Œä½†è§£æé€»è¾‘æ²¡æœ‰æ­£ç¡®æå–æ•°æ®

---

## âœ… å·²ä¿®å¤çš„å†…å®¹

### 1. æ”¹è¿›äº†æ•°æ®è§£æé€»è¾‘ï¼ˆç¬¬ 112-143 è¡Œï¼‰

**æ–°å¢äº†å¤šç§æ•°æ®è·¯å¾„æ£€æŸ¥ï¼š**

```javascript
// å°è¯•å¤šç§å¯èƒ½çš„æ•°æ®è·¯å¾„
if (data.data?.outputs?.result) {
    parsedData = data.data.outputs.result;
} else if (data.data?.outputs?.pois) {
    parsedData = data.data.outputs.pois;
} else if (data.data?.outputs) {
    // ğŸ” æ£€æŸ¥ outputs ä¸­çš„æ‰€æœ‰å±æ€§
    const outputs = data.data.outputs;
    for (const key in outputs) {
        if (Array.isArray(outputs[key])) {
            parsedData = outputs[key];
            break;
        } else if (outputs[key]?.pois) {
            parsedData = outputs[key].pois;
            break;
        }
    }
}
// ... æ›´å¤šè·¯å¾„æ£€æŸ¥
```

### 2. æ·»åŠ äº†è°ƒè¯•æ—¥å¿—ï¼ˆç¬¬ 108-110 è¡Œï¼‰

å½“æ¥æ”¶åˆ° `workflow_finished` äº‹ä»¶æ—¶ï¼Œä¼šè¾“å‡ºå®Œæ•´çš„æ•°æ®ç»“æ„ï¼š

```javascript
if (data.event === 'workflow_finished') {
    console.log('ğŸ¯ å·¥ä½œæµå®Œæˆï¼Œå®Œæ•´æ•°æ®ç»“æ„:', JSON.stringify(data, null, 2));
}
```

---

## ğŸ§ª è°ƒè¯•æ­¥éª¤

### ç¬¬ 1 æ­¥ï¼šæ¸…ç©ºæ§åˆ¶å°ï¼Œé‡æ–°æœç´¢

1. æ‰“å¼€æµè§ˆå™¨å¼€å‘è€…å·¥å…·ï¼ˆF12ï¼‰
2. æ¸…ç©ºæ§åˆ¶å°
3. åœ¨æœç´¢æ¡†è¾“å…¥å…³é”®è¯ï¼ˆå¦‚"å…¬å›­"ï¼‰
4. æŒ‰ Enter æœç´¢

### ç¬¬ 2 æ­¥ï¼šæŸ¥çœ‹è°ƒè¯•æ—¥å¿—

åœ¨æ§åˆ¶å°ä¸­æŸ¥æ‰¾ä»¥ä¸‹å…³é”®æ—¥å¿—ï¼š

**âœ… æˆåŠŸçš„æ—¥å¿—ï¼š**
```
ğŸ“¦ æ¥æ”¶åˆ°æ•°æ®å—: {event: 'workflow_finished', ...}
ğŸ¯ å·¥ä½œæµå®Œæˆï¼Œå®Œæ•´æ•°æ®ç»“æ„: {
  "event": "workflow_finished",
  "data": {
    "outputs": {
      "pois": [...]  â† è¿™é‡Œæ˜¯æ•°æ®
    }
  }
}
âœ… æˆåŠŸè§£ææ•°æ®: 20 æ¡
ğŸ”„ å®æ—¶æ›´æ–°ç»“æœ: 20 æ¡
```

**âŒ å¤±è´¥çš„æ—¥å¿—ï¼ˆå¦‚æœè¿˜æ˜¯æ²¡æ•°æ®ï¼‰ï¼š**
```
ğŸ“¦ æ¥æ”¶åˆ°æ•°æ®å—: {event: 'workflow_finished', ...}
ğŸ¯ å·¥ä½œæµå®Œæˆï¼Œå®Œæ•´æ•°æ®ç»“æ„: {...}  â† å¤åˆ¶è¿™ä¸ªå®Œæ•´çš„JSON
âš ï¸ æœªè§£æåˆ°æ•°æ®
```

### ç¬¬ 3 æ­¥ï¼šåˆ†ææ•°æ®ç»“æ„

å¦‚æœä»ç„¶å¤±è´¥ï¼Œæ‰¾åˆ° `ğŸ¯ å·¥ä½œæµå®Œæˆ` çš„æ—¥å¿—ï¼Œå¤åˆ¶å®Œæ•´çš„ JSON æ•°æ®ç»“æ„ï¼Œç„¶åï¼š

**æ£€æŸ¥æ•°æ®åœ¨å“ªä¸ªè·¯å¾„ï¼š**
```json
{
  "event": "workflow_finished",
  "data": {
    "outputs": {
      "text": "{\"pois\": [...]}"  â† å¦‚æœæ•°æ®åœ¨è¿™é‡Œï¼ˆå­—ç¬¦ä¸²æ ¼å¼ï¼‰
    }
  }
}
```

æˆ–è€…ï¼š
```json
{
  "event": "workflow_finished",
  "data": {
    "outputs": {
      "result": [...]  â† æ•°æ®åœ¨è¿™é‡Œï¼ˆæ•°ç»„æ ¼å¼ï¼‰
    }
  }
}
```

---

## ğŸ“‹ å¸¸è§æ•°æ®ç»“æ„åŠè§£æ

### ç»“æ„ 1: `data.data.outputs.pois` âœ… å·²æ”¯æŒ

```json
{
  "event": "workflow_finished",
  "data": {
    "outputs": {
      "pois": [{"id": "...", "name": "..."}]
    }
  }
}
```

### ç»“æ„ 2: `data.data.outputs.result` âœ… å·²æ”¯æŒ

```json
{
  "event": "workflow_finished",
  "data": {
    "outputs": {
      "result": [{"id": "...", "name": "..."}]
    }
  }
}
```

### ç»“æ„ 3: `data.data.outputs.text`ï¼ˆå­—ç¬¦ä¸²ï¼‰âš ï¸ éœ€è¦é¢å¤–å¤„ç†

```json
{
  "event": "workflow_finished",
  "data": {
    "outputs": {
      "text": "{\"pois\": [...]}"
    }
  }
}
```

å¦‚æœæ˜¯è¿™ç§æƒ…å†µï¼Œéœ€è¦å†è§£æä¸€æ¬¡å­—ç¬¦ä¸²ã€‚

### ç»“æ„ 4: åŠ¨æ€å­—æ®µå âœ… å·²æ”¯æŒ

```json
{
  "event": "workflow_finished",
  "data": {
    "outputs": {
      "æœç´¢ç»“æœ": [{"id": "...", "name": "..."}]
    }
  }
}
```

ä»£ç ä¼šè‡ªåŠ¨éå† `outputs` ä¸­çš„æ‰€æœ‰å±æ€§ï¼Œæ‰¾åˆ°ç¬¬ä¸€ä¸ªæ•°ç»„ã€‚

---

## ğŸ”§ å¦‚æœè¿˜æ˜¯ä¸è¡Œ

### æ–¹æ¡ˆ A: æ·»åŠ  text å­—æ®µè§£æ

å¦‚æœæ•°æ®åœ¨ `data.data.outputs.text` ä¸­ï¼Œä¸”æ˜¯å­—ç¬¦ä¸²æ ¼å¼ï¼Œéœ€è¦æ·»åŠ ï¼š

åœ¨ç¬¬ 115 è¡Œåé¢æ·»åŠ ï¼š
```javascript
} else if (data.data?.outputs?.text) {
    // å°è¯•è§£æ text å­—æ®µï¼ˆå¯èƒ½æ˜¯ JSON å­—ç¬¦ä¸²ï¼‰
    try {
        const textData = JSON.parse(data.data.outputs.text);
        if (textData.pois) {
            parsedData = textData.pois;
        } else if (Array.isArray(textData)) {
            parsedData = textData;
        }
    } catch (e) {
        console.warn('text å­—æ®µä¸æ˜¯æœ‰æ•ˆçš„ JSON');
    }
```

### æ–¹æ¡ˆ B: é€šç”¨è§£æï¼ˆæœ€åçš„å¤‡é€‰ï¼‰

åœ¨ç¬¬ 137 è¡Œåé¢æ·»åŠ ï¼š
```javascript
} else if (data.data?.outputs) {
    // æœ€åçš„å°è¯•ï¼šæ·±åº¦æœç´¢æ‰€æœ‰å¯èƒ½çš„æ•°ç»„
    const findArray = (obj) => {
        for (const key in obj) {
            if (Array.isArray(obj[key])) {
                return obj[key];
            } else if (typeof obj[key] === 'object' && obj[key] !== null) {
                const result = findArray(obj[key]);
                if (result) return result;
            }
        }
        return null;
    };
    parsedData = findArray(data.data.outputs);
```

---

## ğŸ“Š é¢„æœŸçš„æ§åˆ¶å°è¾“å‡º

### æ­£å¸¸æƒ…å†µï¼ˆæˆåŠŸï¼‰ï¼š

```
å¼€å§‹æœç´¢ å…¬å›­
ç”¨æˆ·ä½ç½® {lng: 114.522601, lat: 37.997527, ...}
è¯·æ±‚URL: https://api.dify.ai/v1/workflows/run
è¯·æ±‚ä½“ {inputs: {keyword: "å…¬å›­", location: "114.522601,37.997527"}, ...}
å“åº”çŠ¶æ€ 200

ğŸ“¦ æ¥æ”¶åˆ°æ•°æ®å—: {event: 'workflow_started', ...}
ğŸ“¦ æ¥æ”¶åˆ°æ•°æ®å—: {event: 'node_started', ...}
ğŸ“¦ æ¥æ”¶åˆ°æ•°æ®å—: {event: 'node_finished', ...}
... (å¾ˆå¤šæ¶ˆæ¯)
ğŸ“¦ æ¥æ”¶åˆ°æ•°æ®å—: {event: 'workflow_finished', ...}
ğŸ¯ å·¥ä½œæµå®Œæˆï¼Œå®Œæ•´æ•°æ®ç»“æ„: {...}
âœ… æˆåŠŸè§£ææ•°æ®: 20 æ¡
ğŸ”„ å®æ—¶æ›´æ–°ç»“æœ: 20 æ¡
âœ… æµå¼è¾“å‡ºå®Œæˆ
ğŸ¯ æœ€ç»ˆç»“æœ: [20ä¸ªåœ°ç‚¹å¯¹è±¡]
```

### å¼‚å¸¸æƒ…å†µï¼ˆå¤±è´¥ï¼‰ï¼š

```
... (1000+ æ¡æ¶ˆæ¯)
ğŸ“¦ æ¥æ”¶åˆ°æ•°æ®å—: {event: 'workflow_finished', ...}
ğŸ¯ å·¥ä½œæµå®Œæˆï¼Œå®Œæ•´æ•°æ®ç»“æ„: {...}  â† æ£€æŸ¥è¿™é‡Œçš„æ•°æ®ç»“æ„
âœ… æµå¼è¾“å‡ºå®Œæˆ
ğŸ¯ æœ€ç»ˆç»“æœ: []  â† ç©ºæ•°ç»„
æœªæ‰¾åˆ°æœç´¢ç»“æœ  â† æ˜¾ç¤ºé”™è¯¯
```

---

## ğŸ’¡ è°ƒè¯•æŠ€å·§

### 1. æ‰‹åŠ¨å¤åˆ¶æ•°æ®ç»“æ„

æ‰¾åˆ° `ğŸ¯ å·¥ä½œæµå®Œæˆï¼Œå®Œæ•´æ•°æ®ç»“æ„:` åé¢çš„ JSONï¼Œå¤åˆ¶åˆ°åœ¨çº¿ JSON æ ¼å¼åŒ–å·¥å…·ï¼š
- https://jsonformatter.org/
- https://www.json.cn/

æŸ¥çœ‹æ•°æ®çš„å®Œæ•´è·¯å¾„ã€‚

### 2. åœ¨æ§åˆ¶å°æ‰‹åŠ¨æµ‹è¯•

åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­ç²˜è´´ï¼š
```javascript
const testData = {ç²˜è´´ä½ çš„å®Œæ•´JSONæ•°æ®};
console.log('æ•°æ®è·¯å¾„æµ‹è¯•:');
console.log('data.data.outputs.result:', testData.data?.outputs?.result);
console.log('data.data.outputs.pois:', testData.data?.outputs?.pois);
console.log('data.data.outputs:', testData.data?.outputs);
```

çœ‹çœ‹å“ªä¸ªè·¯å¾„æœ‰æ•°æ®ã€‚

### 3. æ£€æŸ¥æ•°æ®ç±»å‹

```javascript
const outputs = testData.data?.outputs;
for (const key in outputs) {
    console.log(`${key}:`, typeof outputs[key], outputs[key]);
}
```

---

## ğŸ¯ è§£å†³æ–¹æ¡ˆæ€»ç»“

1. âœ… **å·²æ”¹è¿›è§£æé€»è¾‘**ï¼Œæ”¯æŒå¤šç§æ•°æ®è·¯å¾„
2. âœ… **å·²æ·»åŠ è°ƒè¯•æ—¥å¿—**ï¼Œå¯ä»¥æŸ¥çœ‹å®Œæ•´æ•°æ®ç»“æ„
3. ğŸ” **æŸ¥çœ‹æ§åˆ¶å°æ—¥å¿—**ï¼Œæ‰¾åˆ° `ğŸ¯ å·¥ä½œæµå®Œæˆ` çš„æ•°æ®
4. ğŸ“ **æ ¹æ®å®é™…æ•°æ®ç»“æ„**ï¼Œè°ƒæ•´è§£æé€»è¾‘

---

## ğŸ“ å¦‚æœè¿˜éœ€è¦å¸®åŠ©

è¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
1. æ§åˆ¶å°ä¸­ `ğŸ¯ å·¥ä½œæµå®Œæˆï¼Œå®Œæ•´æ•°æ®ç»“æ„:` çš„å®Œæ•´ JSON
2. æœç´¢å…³é”®è¯æ˜¯ä»€ä¹ˆ
3. æ˜¯å¦æœ‰ `âœ… æˆåŠŸè§£ææ•°æ®` çš„æ—¥å¿—

è¿™æ ·æˆ‘å¯ä»¥ç²¾ç¡®å®šä½é—®é¢˜æ‰€åœ¨ã€‚

---

**æ›´æ–°æ—¶é—´ï¼š** 2025-10-28  
**ç‰ˆæœ¬ï¼š** v2.0 - æµå¼ä¼ è¾“å¢å¼ºç‰ˆ

