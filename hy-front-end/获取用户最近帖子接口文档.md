# 获取用户最近一次发布帖子接口文档

## 接口说明
获取指定用户最近一次发布的帖子，返回帖子的所有详细信息。

---

## 接口地址
```
GET /api/post/latest/{userId}
```

## 请求参数

### 路径参数
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| userId | Long | 是 | 用户ID |

### 请求头
| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| Authorization | String | 否 | 登录用户的token（Bearer token） |

**注意事项**
- 未登录用户也可以访问此接口
- 登录用户访问时会自动增加浏览量（不包括查看自己的帖子）
- 登录用户会收到点赞状态等个性化信息

---

## 响应结果

### 成功响应（200）
```json
{
  "code": 200,
  "message": "操作成功",
  "data": {
    "id": 1,
    "publisherId": 123,
    "publisherNickname": "旅行达人",
    "publisherAvatarUrl": "data:image/jpeg;base64,...",
    "title": "杭州三日游攻略",
    "summary": "美丽的西湖之行",
    "content": "这是一次难忘的旅行...",
    "contentType": "richtext",
    "postType": "travel_note",
    "category": "国内游",
    "coverImage": "data:image/jpeg;base64,...",
    "images": ["image1.jpg", "image2.jpg"],
    "videos": ["video1.mp4"],
    "attachments": [],
    "destinationName": "西湖",
    "destinationCity": "杭州",
    "destinationProvince": "浙江",
    "destinationCountry": "China",
    "locations": [
      {
        "name": "西湖",
        "latitude": 30.2591,
        "longitude": 120.1304
      }
    ],
    "travelStartDate": "2024-01-01T00:00:00.000+00:00",
    "travelEndDate": "2024-01-03T00:00:00.000+00:00",
    "travelDays": 3,
    "travelBudget": 3000.00,
    "actualCost": 2800.00,
    "travelSeason": "春季",
    "travelStyle": "休闲游",
    "companionType": "情侣",
    "tags": "西湖,杭州,春游",
    "keywords": "西湖 杭州 旅游",
    "viewCount": 1523,
    "likeCount": 256,
    "commentCount": 89,
    "shareCount": 45,
    "favoriteCount": 123,
    "rating": 4.8,
    "ratingCount": 67,
    "status": "published",
    "isFeatured": false,
    "isTop": false,
    "isOriginal": true,
    "auditStatus": "approved",
    "auditTime": "2024-01-01T10:00:00.000+00:00",
    "createdTime": "2024-01-01T08:00:00.000+00:00",
    "updatedTime": "2024-01-01T09:00:00.000+00:00",
    "publishedTime": "2024-01-01T10:00:00.000+00:00",
    "isLiked": false
  }
}
```

### 错误响应

#### 用户ID为空（400）
```json
{
  "code": 400,
  "message": "用户ID不能为空",
  "data": null
}
```

#### 用户暂无已发布帖子（404）
```json
{
  "code": 404,
  "message": "该用户暂无已发布的帖子",
  "data": null
}
```

#### 服务器内部错误（500）
```json
{
  "code": 500,
  "message": "获取最新帖子失败: 具体错误信息",
  "data": null
}
```

---

## 返回字段说明

### 基本信息
| 字段名 | 类型 | 说明 |
|--------|------|------|
| id | Long | 帖子ID |
| publisherId | Long | 发布者用户ID |
| publisherNickname | String | 发布者昵称 |
| publisherAvatarUrl | String | 发布者头像URL（Base64格式） |
| title | String | 帖子标题 |
| summary | String | 帖子摘要 |
| content | String | 帖子内容 |
| contentType | String | 内容类型（richtext/markdown/html） |
| postType | String | 帖子类型（travel_note/travel_guide等） |
| category | String | 分类 |
| coverImage | String | 封面图片（Base64格式） |

### 多媒体信息
| 字段名 | 类型 | 说明 |
|--------|------|------|
| images | List<String> | 图片列表 |
| videos | List<String> | 视频列表 |
| attachments | List<String> | 附件列表 |

### 目的地信息
| 字段名 | 类型 | 说明 |
|--------|------|------|
| destinationName | String | 目的地名称 |
| destinationCity | String | 目的地城市 |
| destinationProvince | String | 目的地省份 |
| destinationCountry | String | 目的地国家 |
| locations | List<LocationInfo> | 位置信息列表 |

### 旅行信息
| 字段名 | 类型 | 说明 |
|--------|------|------|
| travelStartDate | Date | 旅行开始日期 |
| travelEndDate | Date | 旅行结束日期 |
| travelDays | Integer | 旅行天数 |
| travelBudget | BigDecimal | 旅行预算 |
| actualCost | BigDecimal | 实际花费 |
| travelSeason | String | 旅行季节 |
| travelStyle | String | 旅行风格 |
| companionType | String | 同伴类型 |

### 标签和关键词
| 字段名 | 类型 | 说明 |
|--------|------|------|
| tags | String | 标签（逗号分隔） |
| keywords | String | 关键词 |

### 统计信息
| 字段名 | 类型 | 说明 |
|--------|------|------|
| viewCount | Integer | 浏览次数 |
| likeCount | Integer | 点赞数 |
| commentCount | Integer | 评论数 |
| shareCount | Integer | 分享数 |
| favoriteCount | Integer | 收藏数 |
| rating | BigDecimal | 评分 |
| ratingCount | Integer | 评分人数 |

### 状态信息
| 字段名 | 类型 | 说明 |
|--------|------|------|
| status | String | 帖子状态（published/draft/deleted） |
| isFeatured | Boolean | 是否精选 |
| isTop | Boolean | 是否置顶 |
| isOriginal | Boolean | 是否原创 |
| auditStatus | String | 审核状态（pending/approved/rejected） |
| auditTime | Date | 审核时间 |
| auditReason | String | 审核原因 |

### 时间信息
| 字段名 | 类型 | 说明 |
|--------|------|------|
| createdTime | Date | 创建时间 |
| updatedTime | Date | 更新时间 |
| publishedTime | Date | 发布时间 |
| deletedTime | Date | 删除时间 |

### 用户交互状态
| 字段名 | 类型 | 说明 |
|--------|------|------|
| isLiked | Boolean | 当前用户是否已点赞（仅登录用户） |

---

## 使用示例

### cURL
```bash
# 未登录访问
curl -X GET "http://localhost:8080/api/post/latest/123"

# 登录用户访问
curl -X GET "http://localhost:8080/api/post/latest/123" \
  -H "Authorization: Bearer your-jwt-token"
```

### JavaScript (Axios)
```javascript
// 未登录访问
axios.get('/api/post/latest/123')
  .then(response => {
    console.log('最新帖子:', response.data.data);
  })
  .catch(error => {
    console.error('获取失败:', error.response.data.message);
  });

// 登录用户访问
axios.get('/api/post/latest/123', {
  headers: {
    'Authorization': 'Bearer your-jwt-token'
  }
})
  .then(response => {
    console.log('最新帖子:', response.data.data);
    console.log('是否已点赞:', response.data.data.isLiked);
  })
  .catch(error => {
    console.error('获取失败:', error.response.data.message);
  });
```

### Java (RestTemplate)
```java
// 未登录访问
RestTemplate restTemplate = new RestTemplate();
ResponseDTO response = restTemplate.getForObject(
    "http://localhost:8080/api/post/latest/123",
    ResponseDTO.class
);
PostResponse post = (PostResponse) response.getData();

// 登录用户访问
HttpHeaders headers = new HttpHeaders();
headers.setBearerAuth("your-jwt-token");
HttpEntity<String> entity = new HttpEntity<>(headers);

ResponseDTO response = restTemplate.exchange(
    "http://localhost:8080/api/post/latest/123",
    HttpMethod.GET,
    entity,
    ResponseDTO.class
).getBody();
```

---

## 注意事项

1. **隐私保护**：接口只返回状态为"published"的帖子，草稿和已删除的帖子不会返回

2. **浏览量统计**：
   - 未登录用户访问不会增加浏览量
   - 登录用户查看自己的帖子不会增加浏览量
   - 登录用户查看他人帖子会自动增加浏览量

3. **个性化信息**：
   - 登录用户会收到`isLiked`字段，表示是否已点赞
   - 未登录用户该字段为null

4. **排序规则**：返回该用户最近发布的帖子，按`publishedTime`降序排序

5. **性能优化**：此接口只查询一条记录，性能较好

---

## 相关接口

- `GET /api/post/{postId}` - 获取指定帖子详情
- `GET /api/post/user/{userId}` - 获取用户所有帖子列表
- `GET /api/post/my` - 获取当前登录用户的帖子列表
- `GET /api/post/public` - 获取公开帖子列表

---

## 更新记录

| 日期 | 版本 | 说明 |
|------|------|------|
| 2024-12-06 | 1.0 | 初始版本，实现获取用户最近一次发布帖子功能 |
