# AI 接口返回格式 - 快速参考

## 📋 标准返回格式

```json
{
  "fastest": {
    "time": "时间：20分钟",
    "description": "路径：经过3个红绿灯",
    "cost": "费用：停车费约￥10.00"
  },
  "cheapest": {
    "time": "时间：30分钟",
    "description": "路径：避开收费路段,经过4个红绿灯",
    "cost": "费用：停车费约￥8.00"
  },
  "coordinates": {
    "start": {
      "lng": 116.379028,
      "lat": 39.865042,
      "address": "北京长城"
    },
    "end": {
      "lng": 116.427281,
      "lat": 39.903719,
      "address": "北京天安门"
    }
  }
}
```

## 🔑 关键字段说明

### 必需字段（无坐标版本）
```json
{
  "fastest": {
    "time": "必需：格式为'时间：XX分钟'",
    "description": "必需：路线详细描述",
    "cost": "必需：费用信息"
  },
  "cheapest": {
    "time": "必需：格式为'时间：XX分钟'",
    "description": "必需：路线详细描述",
    "cost": "必需：费用信息"
  }
}
```

### 完整字段（带坐标版本）⭐ 推荐
```json
{
  "fastest": { ... },
  "cheapest": { ... },
  "coordinates": {
    "start": {
      "lng": "必需：经度（number类型）",
      "lat": "必需：纬度（number类型）",
      "address": "可选：地址名称"
    },
    "end": {
      "lng": "必需：经度（number类型）",
      "lat": "必需：纬度（number类型）",
      "address": "可选：地址名称"
    }
  }
}
```

## 🌍 坐标参考

### 主要城市中心坐标（GCJ-02火星坐标系）
| 城市 | 经度 | 纬度 |
|------|------|------|
| 北京 | 116.4074 | 39.9042 |
| 上海 | 121.4737 | 31.2304 |
| 广州 | 113.2644 | 23.1291 |
| 深圳 | 114.0579 | 22.5431 |
| 杭州 | 120.1551 | 30.2741 |
| 南京 | 118.7969 | 32.0603 |
| 成都 | 104.0665 | 30.5723 |
| 西安 | 108.9398 | 34.3416 |

### 北京著名景点
| 景点 | 经度 | 纬度 |
|------|------|------|
| 天安门 | 116.397428 | 39.90923 |
| 故宫 | 116.397128 | 39.917544 |
| 八达岭长城 | 116.379028 | 40.359461 |
| 颐和园 | 116.27537 | 39.999514 |

### 上海著名景点
| 景点 | 经度 | 纬度 |
|------|------|------|
| 外滩 | 121.490317 | 31.241039 |
| 东方明珠 | 121.499763 | 31.239666 |
| 南京路 | 121.477412 | 31.235929 |

### 杭州著名景点
| 景点 | 经度 | 纬度 |
|------|------|------|
| 西湖 | 120.148969 | 30.242865 |
| 灵隐寺 | 120.099166 | 30.242291 |

## ✅ 有效示例

### 示例1：完整坐标
```json
{
  "fastest": {
    "time": "时间：35分钟",
    "description": "路径：地铁2号线→地铁10号线，全程12公里",
    "cost": "费用：￥5.00"
  },
  "cheapest": {
    "time": "时间：52分钟",
    "description": "路径：地铁2号线→公交10号→步行2公里",
    "cost": "费用：￥3.00"
  },
  "coordinates": {
    "start": {
      "lng": 116.397428,
      "lat": 39.90923,
      "address": "北京市东城区天安门"
    },
    "end": {
      "lng": 116.397128,
      "lat": 39.917544,
      "address": "北京市东城区故宫"
    }
  }
}
```

### 示例2：自驾路线
```json
{
  "fastest": {
    "time": "时间：1小时30分钟",
    "description": "路径：G6京藏高速→G7京新高速→德胜门→长安街，全程约70公里",
    "cost": "费用：高速费￥25，停车费￥10"
  },
  "cheapest": {
    "time": "时间：2小时15分钟",
    "description": "路径：避开高速，走国道110→京藏辅路→德胜门→长安街",
    "cost": "费用：停车费￥10"
  },
  "coordinates": {
    "start": {
      "lng": 116.379028,
      "lat": 40.359461
    },
    "end": {
      "lng": 116.397428,
      "lat": 39.90923
    }
  }
}
```

## ❌ 错误示例

### 错误1：缺少必需字段
```json
{
  "fastest": {
    "time": "20分钟"
    // ❌ 缺少 description 和 cost
  }
}
```

### 错误2：坐标格式错误
```json
{
  "coordinates": {
    "start": {
      "longitude": 116.4074,  // ❌ 应该是 lng
      "latitude": 39.9042     // ❌ 应该是 lat
    }
  }
}
```

### 错误3：坐标类型错误
```json
{
  "coordinates": {
    "start": {
      "lng": "116.4074",  // ❌ 应该是数字，不是字符串
      "lat": "39.9042"    // ❌ 应该是数字，不是字符串
    }
  }
}
```

### 错误4：坐标范围错误
```json
{
  "coordinates": {
    "start": {
      "lng": 39.9042,   // ❌ 经纬度颠倒了
      "lat": 116.4074   // ❌ 经纬度颠倒了
    }
  }
}
```

## 📝 Dify 输出节点配置

### 输出变量名（任选其一）
- `text` ✅ 推荐
- `result`
- `output`

### 输出内容
将最终的JSON对象转换为字符串输出：
```
{{#组合数据.result#}}
```

或直接输出LLM生成的JSON：
```
{{#LLM节点.text#}}
```

## 🔍 前端解析路径

前端会尝试以下路径解析数据：
1. `data.data.outputs.text`
2. `data.data.outputs.result`
3. `data.data.outputs.output`
4. `data.outputs.text`
5. `data.outputs.result`
6. 或者 `data.data` 的JSON字符串

## ⚠️ 注意事项

1. **纯JSON输出**：不要在JSON前后添加任何说明文字
2. **数字类型**：经纬度必须是数字，不是字符串
3. **字段命名**：严格使用 `lng`、`lat`，不要用其他名称
4. **坐标系统**：使用GCJ-02（火星坐标），不是WGS84
5. **坐标精度**：建议保留6位小数
6. **坐标范围**：
   - 经度：-180 到 180
   - 纬度：-90 到 90
   - 中国范围：经度 73-135，纬度 18-54

## 📚 相关文档

- `Dify工作流配置-返回坐标.md` - 详细的Dify配置步骤
- `坐标功能-测试说明.md` - 测试步骤和调试指南
- `AI返回数据格式说明.md` - 完整的数据格式说明

